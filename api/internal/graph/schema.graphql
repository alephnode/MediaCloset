# MediaCloset GraphQL Schema
# Proxies external APIs (OMDB, MusicBrainz, Discogs, iTunes, UPC Database)

type Query {
  # Movie/VHS lookups
  movieByTitle(title: String!, director: String, year: Int): MovieData
  movieByBarcode(barcode: String!): MovieData

  # Album/Record lookups
  albumByArtistAndTitle(artist: String!, album: String!): AlbumData
  albumByBarcode(barcode: String!): AlbumData

  # Health check
  health: Health!
}

type Mutation {
  # Save movie/VHS (auto-fetches poster if missing)
  saveMovie(input: SaveMovieInput!): SaveMovieResponse!

  # Save album/record (auto-fetches cover if missing)
  saveAlbum(input: SaveAlbumInput!): SaveAlbumResponse!
}

type MovieData {
  title: String!
  director: String
  year: Int
  genre: String
  posterUrl: String
  plot: String
  source: String!  # "omdb", "upc_database"
}

type AlbumData {
  artist: String
  album: String
  year: Int
  label: String
  genres: [String!]
  coverUrl: String
  tracks: [TrackData!]
  source: String!  # "discogs", "musicbrainz", "itunes"
}

type TrackData {
  title: String!
  trackNumber: Int
  durationSeconds: Int
}

type Health {
  status: String!
  version: String!
  uptime: Int!
}

# Input types for mutations
input SaveMovieInput {
  title: String!
  director: String
  year: Int
  genre: String
  coverUrl: String  # Optional - will be auto-fetched if missing
}

input SaveAlbumInput {
  artist: String!
  album: String!
  year: Int
  label: String
  genre: String
  coverUrl: String  # Optional - will be auto-fetched if missing
}

# Response types for mutations
type SaveMovieResponse {
  success: Boolean!
  id: Int
  movie: SavedMovie
  error: String
}

type SaveAlbumResponse {
  success: Boolean!
  id: Int
  album: SavedAlbum
  error: String
}

# Saved data types (from Hasura)
type SavedMovie {
  id: Int!
  title: String!
  director: String
  year: Int
  genre: String
  coverUrl: String
}

type SavedAlbum {
  id: Int!
  artist: String!
  album: String!
  year: Int
  label: String
  genre: String
  coverUrl: String
}
